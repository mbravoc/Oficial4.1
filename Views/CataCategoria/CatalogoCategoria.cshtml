@model Oficial4.Models.Pecas
@{
    ViewBag.Title = "CATÁLOGO - Cliente";
}

@*<h2>Selecione a Categoria:</h2>
    <select id="selectTipos" name=" ">
        @foreach (var item in Model)
        {
            @Html.ActionLink((string)item.descricao, "IndexAjaxCatalogo", new { descricao = item.id_Tipo.ToString() }), new { target = "_blank" })
            <option value="">text</option>
        }
    </select>*@
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <style>
        h2{
            color:aliceblue;
        }
    </style>
    <div>
        <h2>Selecione Categoria da peça Desejada:</h2>

        <div class="div-select">
            <select id="selecttipos" name=" ">
                @foreach (var item in ViewBag.Tipos)
                {
                    <option class="form-group" value="@item.id_Tipo">@item.descricao</option>
                }
            </select>
        </div>

        <table class="table" id="tbPecas">
            <thead>
                <tr>
                    <th scope="col">Código</th>
                    <th scope="col">Nome</th>
                    <th scope="col">Tipo</th>
                    <th scope="col">Preço</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>


    </div>

<script src="~/Scripts/jquery-3.3.1.intellisense.js"></script>
<script src="~/Scripts/jquery-3.3.1.js"></script>
<script src="~/Scripts/jquery-3.3.1.min.js"></script>


<script type="text/javascript">
    $(document).ready(function () {
        $("#selecttipos").change(function () {
            var idTipo = $("#selecttipos").val();

            var tbPecasBody = $("#tbPecas").find("tbody");
            tbPecasBody.html("");

            $.getJSON("/CataCategoria/RetornaPecasCatalogoAjax/" + idTipo, function (data) {

                $.each(data, function (key, item) {
                    var tdCodigo = $("<td>").append(item.id_Pecas);
                    var tdNome = $("<td>").append(item.nome_Pecas);
                    var tdTipo = $("<td>").append(item.Tipo1.descricao);
                    var tdValor = $("<td>").append(item.preco_Pecas);

                    var tr = $("<tr>").append(tdCodigo)
                        .append(tdNome)
                        .append(tdTipo)
                        .append(tdValor);


                    tbPecasBody.append(tr);
                });
            })
        });
    });
</script>
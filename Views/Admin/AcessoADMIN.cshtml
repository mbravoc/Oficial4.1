@model Oficial4.Controllers.AdminController
@{
    ViewBag.Title = "AcessoADMIN";
    if (Session["nome_Usuario"].ToString() != "adm")
    {
        Response.Redirect("~/Home/Login");
    }
    
}

<h1>  Bem-Vindo <br /> Administrador!  </h1>
<br />
<hr />
<br />
<br />
<h3>Acesso:</h3>
<ul>
    <li>


        @Html.ActionLink("Usuarios", "Index", "Usuario", new { area = "" }, new { @class = "navbar-brand" })

        @Html.ActionLink("Clientes", "Index", "Cliente", new { area = "" }, new { @class = "navbar-brand" })

        @Html.ActionLink("Carros", "Index", "Carro", new { area = "" }, new { @class = "navbar-brand" })

        @Html.ActionLink("Categorias", "Index", "Tipo", new { area = "" }, new { @class = "navbar-brand" })

        @Html.ActionLink("Peças", "Index", "Pecas", new { area = "" }, new { @class = "navbar-brand" })
    </li>

</ul>
<br />
<br />
<br />
<hr />
<br />
<br />
<h4>Procurar por Peça/Categoria/Carro Cadastrados no sistema</h4>

<input type="text" class="form-control text-center" aria-label="Pesquisar" id="pesquisa" placeholder="Pesquisar" />


<div class="div-resultados">
    <h2>Resultados: </h2>

    <div class="div-pecas">
        <h3>Peças</h3>
        <table class="table" id="tbPecas">
            <thead>
                <tr>
                    <th scope="col">Código</th>
                    <th scope="col">Nome</th>
                    <th scope="col">Tipo</th>
                    <th scope="col">Preço</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="div-carros">
        <h3>Carros</h3>
        <table class="table" id="tbCarros">
            <thead>
                <tr>
                    <th scope="col">Código</th>
                    <th scope="col">Nome</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="div-tipos">
        <h3>Tipos:</h3>
        <table class="table" id="tbTipo">
            <thead>
                <tr>
                    <th scope="col">Código</th>
                    <th scope="col">Descrição</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="~/Scripts/jquery-3.3.1.min.js"></script>

<script type="text/javascript">

    $(document).ready(function () {

        function limparTables() {
            var divResultados = $(".div-resultados");
            var divCarros = $(".div-carros");
            var divPecas = $(".div-pecas");
            var divTipos = $(".div-tipos");

            var tbCarrosBody = $("#tbCarros").find("tbody");
            var tbPecasBody = $("#tbPecas").find("tbody");
            var tbTipoBody = $("#tbTipo").find("tbody");

            tbCarrosBody.html("");
            tbPecasBody.html("");
            tbTipoBody.html("");

            divResultados.hide();
            divCarros.hide();
            divPecas.hide();
            divTipos.hide();
        }

        function adicionarItemCarro(item) {
            var divCarros = $(".div-carros");
            var tbCarrosBody = $("#tbCarros").find("tbody");

            divCarros.show();

            var tdCodigo = $("<td>").append(item.codigo);
            var tdNome = $("<td>").append(item.nome);

            var row = $("<tr>").append(tdCodigo)
                .append(tdNome);

            tbCarrosBody.append(row);
        }

        function adicionarItemTipo(item) {
            var divTipos = $(".div-tipos");
            var tbTipoBody = $("#tbTipo").find("tbody");

            divTipos.show();

            var tdCodigo = $("<td>").append(item.codigo);
            var tdNome = $("<td>").append(item.nome);

            var row = $("<tr>").append(tdCodigo)
                .append(tdNome);

            tbTipoBody.append(row);
        }

        function adicionarPeca(item) {
            var divPecas = $(".div-pecas");
            var tbPecasBody = $("#tbPecas").find("tbody");
            divPecas.show();

            var tdCodigo = $("<td>").append(item.codigo);
            var tdNome = $("<td>").append(item.nome);
            var tdTipo = $("<td>").append(item.tipo);
            var tdValor = $("<td>").append(item.valor);

            var row = $("<tr>").append(tdCodigo)
                .append(tdNome)
                .append(tdTipo)
                .append(tdValor);

            tbPecasBody.append(row);

        }

        limparTables();

        $("#pesquisa").keypress(function () {

            var texto = $("#pesquisa").val();

            $.ajax({
                url: "/Admin/RetornaPesquisaADMINAjax",
                data: { "texto": texto },
                dataType: "json",
                type: "GET",
                success: function (data) {
                    limparTables();
                    var divResultados = $(".div-resultados");
                    divResultados.show();

                    $.each(data, function (key, item) {
                        switch (item.type) {
                            case "carro": adicionarItemCarro(item);
                                break;

                            case "tipo": adicionarItemTipo(item);
                                break;

                            case "peca": adicionarPeca(item);
                                break;
                        }
                    });
                }
            });
        });
    });

</script>